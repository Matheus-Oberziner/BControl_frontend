<template>
  <div class="col-12 row shadow-5" style="border-radius: 20px; padding: 25px 0px; margin: 0px 0px 60px;">
    <div class="col-12 row items-start justify-between" :style="$q.screen.width > 1200 ? 'padding: 0px 70px;' : 'padding: 0px 30px;'">
      <div class="row items-center q-py-sm q-px-md topic-style">
        <svg width="45" height="45" viewBox="0 0 60 56" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M48.3812 26.7352C46.3257 26.7365 44.3072 27.2917 42.5315 28.3442C40.7558 29.3968 39.2864 30.909 38.273 32.7268H34.9119V8.76697C34.9112 8.10214 34.651 7.46474 34.1885 6.99463C33.726 6.52452 33.0989 6.26008 32.4449 6.25932H2.46706C1.81298 6.26008 1.18591 6.52452 0.723406 6.99463C0.260905 7.46474 0.000744396 8.10214 0 8.76697L0 52.9923C0.000713441 53.6572 0.260864 54.2946 0.723372 54.7647C1.18588 55.2348 1.81297 55.4993 2.46706 55.5H32.4449C33.0989 55.4993 33.726 55.2348 34.1885 54.7647C34.6511 54.2946 34.9112 53.6572 34.9119 52.9923V52.2682H43.3598C44.0372 52.2648 44.7005 52.0721 45.2775 51.7113C45.8544 51.3506 46.3226 50.8355 46.631 50.2225C48.2126 50.4673 49.8268 50.3775 51.3727 49.9587C52.9185 49.54 54.3626 48.8013 55.6145 47.7889C56.8665 46.7765 57.8992 45.5122 58.6481 44.0753C59.397 42.6383 59.846 41.0597 59.9668 39.4382C60.0876 37.8167 59.8778 36.1874 59.3503 34.6522C58.8229 33.117 57.9892 31.709 56.9016 30.5165C55.814 29.324 54.4958 28.3726 53.0297 27.7219C51.5636 27.0713 49.981 26.7353 48.3812 26.7352ZM26.2014 44.8016C25.6031 44.7972 25.0307 44.5526 24.6092 44.121C24.1876 43.6894 23.951 43.1059 23.951 42.4977C23.951 41.8895 24.1876 41.306 24.6092 40.8744C25.0307 40.4428 25.6031 40.1982 26.2014 40.1938H36.8755C37.1015 41.8311 37.6654 43.4013 38.5301 44.8016H26.2014ZM36.7621 38.5458C36.7621 38.6189 36.7635 38.6916 36.7649 38.7644H26.2014C25.6003 38.7644 25.0238 38.5217 24.5987 38.0896C24.1736 37.6576 23.9349 37.0716 23.9349 36.4605C23.9349 35.8495 24.1736 35.2635 24.5987 34.8315C25.0238 34.3994 25.6003 34.1567 26.2014 34.1567H37.5941C37.043 35.5521 36.7605 37.0421 36.7621 38.5458ZM33.5059 52.9923C33.5056 53.2782 33.3937 53.5523 33.1948 53.7544C32.996 53.9566 32.7263 54.0703 32.4451 54.0706H2.46706C2.18581 54.0703 1.91618 53.9566 1.71731 53.7544C1.51844 53.5523 1.40657 53.2782 1.40626 52.9923V8.76697C1.40661 8.48111 1.51848 8.20706 1.71734 8.00492C1.9162 7.80278 2.18582 7.68907 2.46706 7.68873H32.4449C32.7261 7.68907 32.9957 7.80278 33.1946 8.00492C33.3934 8.20706 33.5053 8.48111 33.5056 8.76697V32.7273H26.2014C25.4258 32.7269 24.67 32.9762 24.0424 33.4395C23.4148 33.9028 22.9477 34.5562 22.7081 35.306C22.4685 36.0558 22.4687 36.8635 22.7086 37.6132C22.9486 38.3629 23.416 39.0161 24.0438 39.4791C23.5747 39.8248 23.1927 40.2786 22.9294 40.8033C22.666 41.328 22.5287 41.9087 22.5287 42.4977C22.5287 43.0867 22.666 43.6674 22.9294 44.1921C23.1927 44.7168 23.5747 45.1706 24.0438 45.5163C23.4161 45.9793 22.9487 46.6325 22.7087 47.3822C22.4688 48.1319 22.4686 48.9396 22.7082 49.6894C22.9478 50.4392 23.4149 51.0926 24.0424 51.5559C24.67 52.0192 25.4258 52.2686 26.2014 52.2682H33.5056L33.5059 52.9923ZM43.3598 50.8388H26.2014C25.6031 50.8345 25.0307 50.5898 24.6092 50.1582C24.1876 49.7266 23.951 49.1431 23.951 48.5349C23.951 47.9267 24.1876 47.3432 24.6092 46.9116C25.0307 46.48 25.6031 46.2354 26.2014 46.231H39.5657C41.0448 47.9845 42.9964 49.2599 45.1799 49.8998C44.9692 50.1894 44.695 50.4251 44.3791 50.5881C44.0631 50.7511 43.7141 50.837 43.3598 50.8388ZM48.3812 48.9271C46.3612 48.9271 44.3866 48.3183 42.707 47.1776C41.0275 46.0369 39.7184 44.4156 38.9454 42.5186C38.1723 40.6217 37.97 38.5344 38.3641 36.5206C38.7582 34.5068 39.7309 32.657 41.1592 31.2052C42.5876 29.7533 44.4074 28.7646 46.3886 28.364C48.3697 27.9634 50.4233 28.169 52.2895 28.9547C54.1557 29.7405 55.7508 31.071 56.8731 32.7782C57.9953 34.4854 58.5943 36.4926 58.5943 38.5458C58.5913 41.2981 57.5143 43.9368 55.5996 45.883C53.685 47.8292 51.089 48.924 48.3812 48.9271ZM51.0297 35.3994C51.0297 35.589 51.1038 35.7708 51.2356 35.9048C51.3675 36.0388 51.5463 36.1141 51.7328 36.1141C51.9193 36.1141 52.0982 36.0388 52.23 35.9048C52.3619 35.7708 52.436 35.589 52.436 35.3994C52.436 33.4989 50.9857 31.9157 49.0844 31.5977V30.3258C49.0844 30.1362 49.0103 29.9544 48.8784 29.8204C48.7466 29.6864 48.5677 29.6111 48.3812 29.6111C48.1947 29.6111 48.0159 29.6864 47.884 29.8204C47.7522 29.9544 47.6781 30.1362 47.6781 30.3258V31.5973C45.7761 31.9154 44.3265 33.4986 44.3265 35.3991C44.3265 37.2996 45.7766 38.8828 47.6781 39.2008V44.0359C46.5578 43.7524 45.7328 42.809 45.7328 41.6919C45.7328 41.5024 45.6587 41.3206 45.5268 41.1866C45.395 41.0525 45.2161 40.9772 45.0296 40.9772C44.8431 40.9772 44.6643 41.0525 44.5324 41.1866C44.4006 41.3206 44.3265 41.5024 44.3265 41.6919C44.3265 43.5926 45.7766 45.1756 47.6781 45.4938V46.7655C47.6781 46.955 47.7522 47.1368 47.884 47.2709C48.0159 47.4049 48.1947 47.4802 48.3812 47.4802C48.5677 47.4802 48.7466 47.4049 48.8784 47.2709C49.0103 47.1368 49.0844 46.955 49.0844 46.7655V45.4942C50.9862 45.176 52.436 43.5929 52.436 41.6923C52.436 39.7917 50.9857 38.2085 49.0844 37.8904V33.0555C50.2047 33.339 51.0302 34.2821 51.0302 35.3994H51.0297ZM45.7318 35.3994C45.7318 34.2821 46.5573 33.3387 47.6772 33.0555V37.7438C46.5578 37.4599 45.7323 36.5169 45.7323 35.3994H45.7318ZM51.0297 41.6923C51.0297 42.8097 50.2042 43.753 49.0844 44.0364V39.3482C50.2047 39.6317 51.0302 40.575 51.0302 41.6923H51.0297ZM5.6451 22.0441H29.2668C29.4533 22.0441 29.6321 21.9688 29.764 21.8348C29.8959 21.7008 29.9699 21.519 29.9699 21.3294V11.9973C29.9699 11.8078 29.8959 11.626 29.764 11.4919C29.6321 11.3579 29.4533 11.2826 29.2668 11.2826H5.6451C5.45861 11.2826 5.27977 11.3579 5.14791 11.4919C5.01604 11.626 4.94196 11.8078 4.94196 11.9973V21.3294C4.94196 21.519 5.01604 21.7008 5.14791 21.8348C5.27977 21.9688 5.45861 22.0441 5.6451 22.0441ZM6.34823 12.7115H28.5637V20.6147H6.34823V12.7115ZM10.6759 43.9344H5.6451C5.45861 43.9344 5.27977 44.0097 5.14791 44.1438C5.01604 44.2778 4.94196 44.4596 4.94196 44.6491V49.7619C4.94196 49.9514 5.01604 50.1332 5.14791 50.2673C5.27977 50.4013 5.45861 50.4766 5.6451 50.4766H10.6759C10.8624 50.4766 11.0412 50.4013 11.1731 50.2673C11.3049 50.1332 11.379 49.9514 11.379 49.7619V44.6491C11.379 44.4596 11.3049 44.2778 11.1731 44.1438C11.0412 44.0097 10.8624 43.9344 10.6759 43.9344ZM9.97276 49.0472H6.34823V45.3638H9.97276V49.0472ZM10.6759 25.0368H5.6451C5.45861 25.0368 5.27977 25.1121 5.14791 25.2462C5.01604 25.3802 4.94196 25.562 4.94196 25.7515V30.8645C4.94196 31.0541 5.01604 31.2359 5.14791 31.3699C5.27977 31.5039 5.45861 31.5792 5.6451 31.5792H10.6759C10.8624 31.5792 11.0412 31.5039 11.1731 31.3699C11.3049 31.2359 11.379 31.0541 11.379 30.8645V25.7515C11.379 25.562 11.3049 25.3802 11.1731 25.2462C11.0412 25.1121 10.8624 25.0368 10.6759 25.0368ZM9.97276 30.1498H6.34823V26.4662H9.97276V30.1498ZM10.6759 34.4857H5.6451C5.45861 34.4857 5.27977 34.561 5.14791 34.695C5.01604 34.8291 4.94196 35.0108 4.94196 35.2004V40.3131C4.94196 40.5027 5.01604 40.6845 5.14791 40.8185C5.27977 40.9526 5.45861 41.0279 5.6451 41.0279H10.6759C10.8624 41.0279 11.0412 40.9526 11.1731 40.8185C11.3049 40.6845 11.379 40.5027 11.379 40.3131V35.2003C11.379 35.0107 11.3049 34.8289 11.1731 34.6949C11.0412 34.5609 10.8624 34.4856 10.6759 34.4856V34.4857ZM9.97276 39.5986H6.34823V35.915H9.97276V39.5986ZM19.9715 43.9344H14.9409C14.7544 43.9344 14.5755 44.0097 14.4437 44.1438C14.3118 44.2778 14.2377 44.4596 14.2377 44.6491V49.7619C14.2377 49.9514 14.3118 50.1332 14.4437 50.2673C14.5755 50.4013 14.7544 50.4766 14.9409 50.4766H19.9709C20.1574 50.4766 20.3363 50.4013 20.4681 50.2673C20.6 50.1332 20.6741 49.9514 20.6741 49.7619V44.6491C20.6741 44.4596 20.6 44.2778 20.4681 44.1438C20.3363 44.0097 20.1574 43.9344 19.9709 43.9344H19.9715ZM19.2684 49.0472H15.644V45.3638H19.2678L19.2684 49.0472ZM19.9715 25.0368H14.9409C14.7544 25.0368 14.5755 25.1121 14.4437 25.2462C14.3118 25.3802 14.2377 25.562 14.2377 25.7515V30.8645C14.2377 31.0541 14.3118 31.2359 14.4437 31.3699C14.5755 31.5039 14.7544 31.5792 14.9409 31.5792H19.9709C20.1574 31.5792 20.3363 31.5039 20.4681 31.3699C20.6 31.2359 20.6741 31.0541 20.6741 30.8645V25.7515C20.6741 25.562 20.6 25.3802 20.4681 25.2462C20.3363 25.1121 20.1574 25.0368 19.9709 25.0368H19.9715ZM19.2684 30.1498H15.644V26.4662H19.2678L19.2684 30.1498ZM19.9715 34.4857H14.9409C14.7544 34.4857 14.5755 34.561 14.4437 34.695C14.3118 34.8291 14.2377 35.0108 14.2377 35.2004V40.3131C14.2377 40.5027 14.3118 40.6845 14.4437 40.8185C14.5755 40.9526 14.7544 41.0279 14.9409 41.0279H19.9709C20.1574 41.0279 20.3363 40.9526 20.4681 40.8185C20.6 40.6845 20.6741 40.5027 20.6741 40.3131V35.2003C20.6741 35.0107 20.6 34.8289 20.4681 34.6949C20.3363 34.5609 20.1574 34.4856 19.9709 34.4856L19.9715 34.4857ZM19.2684 39.5986H15.644V35.915H19.2678L19.2684 39.5986ZM29.2674 25.037H24.2366C24.0501 25.037 23.8713 25.1123 23.7394 25.2463C23.6076 25.3803 23.5335 25.5621 23.5335 25.7517V30.8647C23.5335 31.0542 23.6076 31.236 23.7394 31.37C23.8713 31.5041 24.0501 31.5794 24.2366 31.5794H29.2668C29.4533 31.5794 29.6321 31.5041 29.764 31.37C29.8959 31.236 29.9699 31.0542 29.9699 30.8647V25.7515C29.9699 25.562 29.8959 25.3802 29.764 25.2462C29.6321 25.1121 29.4533 25.0368 29.2668 25.0368L29.2674 25.037ZM28.5643 30.15H24.9397V26.4662H28.5637L28.5643 30.15ZM47.3538 0.5H41.5434C41.3569 0.5 41.1781 0.575299 41.0462 0.709332C40.9143 0.843365 40.8403 1.02515 40.8403 1.2147V14.3287H36.9379C36.8049 14.3287 36.6746 14.367 36.5621 14.4393C36.4497 14.5115 36.3597 14.6147 36.3027 14.7368C36.2456 14.8589 36.2238 14.995 36.2398 15.1292C36.2558 15.2634 36.3089 15.3903 36.3929 15.4951L43.9038 24.8577C43.9697 24.9399 44.0528 25.0061 44.1471 25.0516C44.2414 25.0971 44.3444 25.1207 44.4487 25.1207C44.5531 25.1207 44.6561 25.0971 44.7504 25.0516C44.8446 25.0061 44.9277 24.9399 44.9937 24.8577L52.5046 15.4951C52.5887 15.3903 52.6418 15.2634 52.6578 15.1292C52.6737 14.995 52.6519 14.8589 52.5949 14.7368C52.5378 14.6147 52.4479 14.5115 52.3354 14.4393C52.223 14.367 52.0927 14.3287 51.9597 14.3287H48.0573V1.2147C48.0573 1.12082 48.0391 1.02785 48.0038 0.941116C47.9684 0.854381 47.9166 0.775576 47.8512 0.709205C47.7859 0.642834 47.7084 0.590197 47.623 0.554301C47.5377 0.518405 47.4462 0.499953 47.3538 0.5ZM50.479 15.7581L44.4486 23.2755L38.4183 15.7581H41.5434C41.7299 15.7581 41.9087 15.6828 42.0406 15.5488C42.1724 15.4147 42.2465 15.2329 42.2465 15.0434V1.92941H46.6506V15.0434C46.6506 15.2329 46.7247 15.4147 46.8565 15.5488C46.9884 15.6828 47.1672 15.7581 47.3537 15.7581H50.479Z" fill="#0047A1"/>
        </svg>

        <span class="font-1 text-28 weight-500 text-blue q-pl-md text-center">Despesas por Centro de Custo</span>
      </div>

      <div class="row items-center q-gutter-md" :class="$q.screen.width > 1350 ? 'offset-md-1' : 'q-pl-md'">
        <span class="text-16 text-grey-7">Total:</span>
        <q-input
          model-value="R$ 520.000,00"
          outlined
          dense
          input-class="text-center"
          style="text-transform: uppercase; max-width: 150px;"
        />
        <span class="text-16 text-grey-7">Sobre o Faturamento:</span>
        <DonutRadial
          :value="25"
          :size="110"
          :stroke-width="16"
          semicircle
          progress-color="#0047A1"
          rest-color=""
          :rest-pattern-angle="110"
          rest-pattern-color="#dadada"
          :rest-pattern-stripe="1"
          :rest-pattern-gap="3"
        >
          <template #center-label>
            <div class="label-center q-pt-lg">
              <span class="text-18 weight-600" :style="{ color: '#0047A1' }">25%</span>
            </div>
          </template>
        </DonutRadial>
      </div>
    </div>

    <div class="col-12 row" style="padding: 40px 70px;">
      <div class="col-4 row justify-center items-center">
        <SegmentedPizza :segments="array" :gap-angle="2" :gap-width="5" :size="280" />
      </div>

      <div
        v-for="(a, index) in array"
        :key="index"
        class="col-4 row justify-center"
      >
        <div
          class="row items-center q-ma-sm"
          :style="{ border: `1px solid ${a.color}` }"
          style="border-radius: 15px; max-width: 100%; width: 450px;"
        >
          <div
            class="col-12 row justify-between items-center q-py-md q-px-lg"
            :style="{ borderBottom: `2px solid ${a.color}` }"
          >
            <div class="row items-center text-grey-2">
              <span class="col-12 text-18 text-blue weight-600 q-pb-sm">{{ a.label }}</span>
              <span class="text-12 q-pr-xs weight-500 text-center">R$</span><span class="text-16 weight-500">{{ a.value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</span>
            </div>

            <DonutRadial
              :value="25"
              :size="110"
              :stroke-width="16"
              semicircle
              :progress-color="a.color"
              rest-color=""
              :rest-pattern-angle="110"
              rest-pattern-color="#dadada"
              :rest-pattern-stripe="1"
              :rest-pattern-gap="3"
            >
              <template #center-label>
                <div class="label-center q-pt-lg">
                  <span class="text-18 weight-600" :style="{ color: '#0047A1' }">25%</span>
                </div>
              </template>
            </DonutRadial>
          </div>
          
          <div class="row q-px-md q-pb-md q-pt-lg">
            <div
              v-for="(c, idx) in a.charts"
              :key="idx"
              class="col-12 row justify-center q-my-md"
              style="position: relative;"
            >
              <div class="hbar hbar--right" :style="{ '--h': '300px', '--w': '20px' }">
                <CustomBarChart
                  class="hbar__inner"
                  height="320px"
                  width="20px"
                  :onlyBar="true"
                  :sideTitle="null"
                  :chartData="[
                    { value: 50, label: 'Projetado', color: '#e7e7e7', bgColor: '#f6f6f6' },
                    { value: c.value, label: 'Faturamento', color: '#0047A1', bgColor: a.color }
                  ]"
                />
              </div>

              <div class="text-16 text-grey-2 q-pl-lg">
                {{ c.value }}%
              </div>
              <div class="col-12 text-grey-2 q-pl-lg">Salários</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import CustomBarChart from '../CustomBarChart.vue'
import DonutRadial from '../DonutRadial.vue'
import SegmentedPizza from '../SegmentedPizza.vue'
export default {
  components: {
    DonutRadial,
    SegmentedPizza,
    CustomBarChart
  },

  data () {
    return {
      array: [
        { 
          label: 'Administrativo',
          percent: 15,
          color: '#4090F2',
          value: 78000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        { 
          label: 'Operacional',
          percent: 20,
          color: '#FFA167', 
          value: 104000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        {
          label: 'Comercial',
          percent: 15,
          color: '#58C377',
          value: 78000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        {
          label: 'Marketing',
          percent: 15,
          color: '#95F0A9',
          value: 78000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        { 
          label: 'CS Suporte',
          percent: 10,
          color: '#CCA9DD',
          value: 52000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        {
          label: 'Tecnologia',
          percent: 10,
          color: '#E7DDFF',
          value: 52000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        {
          label: 'Logística',
          percent: 10,
          color: '#FFA8DC',
          value: 52000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        },
        {
          label: 'Sem Categoria', 
          percent: 5, 
          color: '#0047A1', 
          value: 26000,
          charts: [
            { value: 40 },
            { value: 30 },
            { value: 20 },
            { value: 10 }
          ]
        }
      ]
    }
  }
}
</script>
<style scoped>
.hbar{
  inline-size: var(--h);   /* = height do chart */
  block-size: var(--w);    /* = width do chart  */
  display: inline-grid;
}

.hbar__inner{
  inline-size: var(--w);
  block-size: var(--h);
  transform-origin: left top;
  transform-box: border-box;  /* garante % consistentes */
}

/* topo → direita (horizontal correta dentro do card) */
.hbar--right > .hbar__inner{
  rotate: -90deg;
  translate: 1550% 0;
  scale: 1 -1;
  margin-top: 20px;
}

/* Fallback (navegadores sem rotate/translate individuais) */
@supports not (rotate: 0deg){
  .hbar--right > .hbar__inner{
    transform: rotate(90deg) translateY(-100%);
  }
}

</style>
